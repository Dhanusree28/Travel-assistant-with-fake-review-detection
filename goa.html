<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Goa Coastal Adventure: Dolphin and Island Cruise</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f4f9ff;
      color: #333;
    }
    header {
      background-color: #003366;
      color: white;
      text-align: center;
      padding: 50px 20px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }
    header h1 {
      font-size: 42px;
      margin-bottom: 10px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    header p {
      font-size: 18px;
      margin-top: 5px;
    }
    .container {
      max-width: 1200px;
      margin: 40px auto;
      padding: 0 20px;
    }
    .gallery {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
      margin-bottom: 50px;
    }
    .gallery-item {
      overflow: hidden;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
    }
    .gallery-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.4s ease;
    }
    .gallery-item:hover img {
      transform: scale(1.05);
    }
    .main-section {
      display: flex;
      flex-wrap: wrap;
      gap: 30px;
      margin-bottom: 60px;
    }
    .tour-details {
      flex: 1;
      min-width: 300px;
      background: #fff;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    .price-box {
      flex-basis: 300px;
      background: #fff;
      padding: 30px;
      height: fit-content;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    .detail-item {
      display: flex;
      align-items: start;
      margin-bottom: 20px;
    }
    .detail-item i {
      font-size: 22px;
      color: #0071eb;
      margin-right: 15px;
      margin-top: 3px;
    }
    .detail-text {
      font-size: 16px;
      color: #555;
    }
    .price-box p {
      font-size: 22px;
      margin-bottom: 20px;
      color: #333;
    }
    .price-box button {
      background-color: #0071eb;
      color: white;
      border: none;
      padding: 15px 25px;
      font-size: 18px;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    .price-box button:hover {
      background-color: #005bb5;
    }
    section h2 {
      font-size: 28px;
      color: #003366;
      margin-bottom: 20px;
    }
    section ul, section p {
      font-size: 16px;
      color: #555;
      line-height: 1.6;
    }
    .reviews {
      background: #fff;
      padding: 40px;
      border-radius: 12px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      margin-top: 60px;
    }
    .overall-rating {
      display: flex;
      align-items: center;
      gap: 20px;
      margin-bottom: 20px;
    }
    .overall-rating .stars {
      color: #ffc107;
      font-size: 1.2rem;
    }
    .overall-rating p {
      font-size: 1.5rem;
      font-weight: 600;
    }
    .rating-breakdown {
      margin-left: 20px;
    }
    .rating-breakdown div {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 5px;
      font-size: 0.9rem;
    }
    .rating-breakdown .bar {
      width: 100px;
      height: 8px;
      background: #e0e0e0;
      border-radius: 4px;
      overflow: hidden;
    }
    .rating-breakdown .fill {
      height: 100%;
      background: #ffc107;
    }
    .customer-photos {
      display: grid;
      grid-template-columns: repeat(6, 1fr);
      gap: 10px;
      margin-bottom: 20px;
    }
    .customer-photos img {
      width: 100%;
      height: 100px;
      object-fit: cover;
      border-radius: 8px;
      cursor: pointer;
    }
    .upload-photo {
      margin-bottom: 20px;
    }
    .upload-photo input[type="file"] {
      padding: 10px;
      font-size: 16px;
    }
    #loading {
      display: none;
      color: #007bff;
      font-weight: bold;
      margin: 10px 0;
    }
    #progress {
      display: none;
      margin: 10px 0;
    }
    #error {
      display: none;
      color: #dc3545;
      font-weight: bold;
      margin: 10px 0;
    }
    .review-form {
      margin-top: 30px;
      background: #f9f9f9;
      padding: 20px;
      border-radius: 8px;
    }
    .review-form h3 {
      font-size: 20px;
      color: #003366;
      margin-bottom: 15px;
    }
    .review-form label {
      display: block;
      font-size: 16px;
      color: #333;
      margin-bottom: 5px;
    }
    .review-form input[type="text"],
    .review-form textarea,
    .review-form select {
      width: 100%;
      padding: 10px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 8px;
      margin-bottom: 15px;
      box-sizing: border-box;
    }
    .review-form button {
      background-color: #0071eb;
      color: white;
      border: none;
      padding: 12px 20px;
      font-size: 16px;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    .review-form button:hover {
      background-color: #005bb5;
    }
    .filters {
      display: flex;
      justify-content: space-between;
      margin-bottom: 20px;
    }
    .filter-group {
      display: flex;
      flex-direction: column;
      gap: 5px;
    }
    .filter-group h3 {
      font-size: 1rem;
      color: #333;
      margin-bottom: 5px;
    }
    .filter-group label {
      display: flex;
      align-items: center;
      gap: 5px;
      font-size: 0.9rem;
      color: #555;
    }
    .search-bar {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .search-bar input {
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 20px;
      width: 200px;
      font-size: 0.9rem;
    }
    .search-bar select {
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 0.9rem;
    }
    .review-card {
      border-bottom: 1px solid #e0e0e0;
      padding: 15px 0;
      display: none;
    }
    .review-card.visible {
      display: flex;
    }
    .review-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
    }
    .review-header .avatar {
      width: 40px;
      height: 40px;
      background: #ff5722;
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1rem;
      font-weight: 600;
    }
    .review-header .stars {
      color: #ffc107;
      font-size: 1rem;
    }
    .review-header .author {
      font-weight: 600;
      color: #333;
    }
    .review-header .date {
      font-size: 0.8rem;
      color: #777;
    }
    .review-card p {
      font-size: 0.9rem;
      line-height: 1.6;
      color: #555;
    }
    .review-status {
      margin-top: 10px;
      font-size: 0.9rem;
    }
    .see-more {
      text-align: center;
      margin-top: 20px;
    }
    .see-more button {
      background-color: #0071eb;
      color: white;
      padding: 12px 20px;
      font-size: 16px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    .see-more button:hover {
      background-color: #005bb5;
    }
    a {
      color: #0071eb;
      text-decoration: underline;
    }
    .fullscreen-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      z-index: 1000;
      justify-content: center;
      align-items: center;
    }
    .fullscreen-modal img {
      max-width: 90%;
      max-height: 90%;
      object-fit: contain;
      border-radius: 8px;
    }
    .fullscreen-modal .close-btn {
      position: absolute;
      top: 20px;
      right: 20px;
      background: #0071eb;
      color: white;
      border: none;
      padding: 10px 15px;
      font-size: 16px;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    .fullscreen-modal .close-btn:hover {
      background: #005bb5;
    }
    .itinerary-buttons {
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
      margin-top: 20px;
    }
    @media (max-width: 768px) {
      .customer-photos {
        grid-template-columns: repeat(2, 1fr);
      }
      .filters {
        flex-direction: column;
        gap: 10px;
      }
      .search-bar {
        width: 100%;
      }
      .search-bar input {
        width: 100%;
      }
      .itinerary-buttons {
        flex-direction: column;
        align-items: flex-start;
      }
    }
  </style>
</head>
<body>

<header>
  <h1>Goa Coastal Adventure: Dolphin and Island Cruise</h1>
  <p>Discover the vibrant marine life and serene islands of Goa on a luxurious cruise</p>
</header>

<div class="container">

  <div class="gallery">
    <div class="gallery-item"><img src="g1.jpg" alt="Dolphins off Goa coast"></div>
    <div class="gallery-item"><img src="g2.jpg" alt="Goa Island Cruise"></div>
    <div class="gallery-item"><img src="g3.jpg" alt="Goa Coastal View"></div>
    <div class="gallery-item"><img src="g4.webp" alt="Dolphins near Goa"></div>
    <div class="gallery-item"><img src="g5.jpg" alt="Goa Island Exploration"></div>
    <div class="gallery-item"><img src="g6.webp" alt="Scenic Goa Shores"></div>
  </div>

  <div class="main-section">
    <div class="tour-details">
      <h2>About this tour</h2>
      <div class="detail-item">
        <i class="fas fa-calendar-times"></i>
        <div class="detail-text"><strong>Free cancellation</strong><br>Cancel up to 24 hours in advance for a full refund.</div>
      </div>
      <div class="detail-item">
        <i class="fas fa-credit-card"></i>
        <div class="detail-text"><strong>Reserve now & pay later</strong><br>Book your spot and pay nothing today.</div>
      </div>
      <div class="detail-item">
        <i class="fas fa-clock"></i>
        <div class="detail-text"><strong>Duration 8 hours</strong><br>Check availability to see starting times.</div>
      </div>
      <div class="detail-item">
        <i class="fas fa-ticket-alt"></i>
        <div class="detail-text"><strong>Skip the ticket line</strong></div>
      </div>
      <div class="detail-item">
        <i class="fas fa-user"></i>
        <div class="detail-text"><strong>Live tour guide</strong><br>English, Hindi</div>
      </div>
      <div class="detail-item">
        <i class="fas fa-shuttle-van"></i>
        <div class="detail-text"><strong>Pickup included</strong><br>Pickup available from selected hotels in North Goa.</div>
      </div>
      <div class="detail-item">
        <i class="fas fa-wheelchair"></i>
        <div class="detail-text"><strong>Wheelchair accessible</strong></div>
      </div>
    </div>

    <div class="price-box">
      <p>From <strong>₹7,999</strong> per person</p>
      <button onclick="window.location.href='hotels.html'">Check Availability</button>
    </div>
  </div>

  <section>
    <h2>Itinerary</h2>
    <div class="itinerary-buttons">
      <a href="it.html" target="_blank" style="display: inline-block; background-color: #0071eb; color: white; padding: 12px 24px; font-size: 16px; border-radius: 8px; text-decoration: none; transition: background-color 0.3s;">
        View Full Itinerary
      </a>
      <a href="goa-vr.html" style="display: inline-block; background-color: #0071eb; color: white; padding: 12px 24px; font-size: 16px; border-radius: 8px; text-decoration: none; transition: background-color 0.3s;">
        See VR
      </a>
    </div>
  </section>

  <section class="reviews">
    <h2>Customer Reviews</h2>
    <div class="overall-rating">
      <p>4.6/5</p>
      <div class="stars">★★★★★</div>
      <span>Based on 620 reviews</span>
    </div>
    <div class="rating-breakdown">
      <div>
        <span>Guide</span>
        <div class="bar"><div class="fill" style="width: 95%"></div></div>
        <span>4.8/5</span>
      </div>
      <div>
        <span>Transportation</span>
        <div class="bar"><div class="fill" style="width: 92%"></div></div>
        <span>4.6/5</span>
      </div>
      <div>
        <span>Value for money</span>
        <div class="bar"><div class="fill" style="width: 91%"></div></div>
        <span>4.5/5</span>
      </div>
    </div>

    <div class="upload-photo">
      <h3>Share Your Photos</h3>
      <input type="file" id="photo-upload" accept="image/jpeg,image/png" multiple>
      <div id="loading">Processing... (This may take up to 10 minutes)</div>
      <div id="progress">
        <progress value="0" max="100"></progress>
        <span id="progress-text">0%</span>
      </div>
      <div id="error"></div>
    </div>

    <div class="customer-photos" id="customer-photos">
      <!-- Dynamically added photos will appear here -->
    </div>

    <div class="filters">
      <div class="filter-group">
        <h3>Filter</h3>
        <label><input type="checkbox" id="all-types" checked>All traveler types</label>
        <label><input type="checkbox">Couples</label>
        <label><input type="checkbox">Group of friends</label>
        <label><input type="checkbox">Solo travelers</label>
        <label><input type="checkbox">Families</label>
      </div>
      <div class="filter-group">
        <h3>By star rating</h3>
        <label><input type="checkbox" id="all-ratings" checked>All ratings</label>
        <label><input type="checkbox" id="5-stars">5 stars</label>
        <label><input type="checkbox" id="4-stars">4 stars</label>
        <label><input type="checkbox" id="3-stars">3 stars</label>
        <label><input type="checkbox" id="2-stars">2 stars</label>
        <label><input type="checkbox" id="1-star">1 star</label>
      </div>
      <div class="search-bar">
        <input type="text" id="search-reviews" placeholder="Search reviews (e.g. guides)">
        <select id="sort-reviews">
          <option>Sort by: Recommended</option>
          <option>Sort by: Newest</option>
          <option>Sort by: Oldest</option>
        </select>
      </div>
    </div>

    <div id="review-list">
      <div class="review-card visible" data-stars="5">
        <div class="review-header">
          <div class="avatar">V</div>
          <div>
            <div class="stars">★★★★★</div>
            <div class="author">Vignesh — Tamil Nadu, India</div>
            <div class="date">April 23, 2025</div>
          </div>
        </div>
        <p>Amazing experience! The crew was friendly and knowledgeable, guiding us to spot dolphins near Candolim beach. The boat was comfortable, and the views of Goa's coastline were breathtaking.</p>
        <div class="review-status" style="color: #388e3c;">Genuine Review</div>
      </div>
      <div class="review-card visible" data-stars="5">
        <div class="review-header">
          <div class="avatar">P</div>
          <div>
            <div class="stars">★★★★★</div>
            <div class="author">Priya — Chennai, Tamil Nadu</div>
            <div class="date">April 22, 2025</div>
          </div>
        </div>
        <p>Fantastic cruise! We saw plenty of dolphins and enjoyed the stop at Grande Island. The staff was welcoming, and the guide spoke fluent Tamil, which was a bonus for us.</p>
        <div class="review-status" style="color: #388e3c;">Genuine Review</div>
      </div>
      <div class="review-card visible" data-stars="4">
        <div class="review-header">
          <div class="avatar">A</div>
          <div>
            <div class="stars">★★★★☆</div>
            <div class="author">Akshaya — Coimbatore, Tamil Nadu</div>
            <div class="date">April 21, 2025</div>
          </div>
        </div>
        <p>Really enjoyed the dolphin spotting near Baga beach. The boat was a bit crowded, but the guides shared interesting facts about Goa's marine life. Would recommend arriving early for a good spot.</p>
        <div class="review-status" style="color: #388e3c;">Genuine Review</div>
      </div>
      <div class="review-card" data-stars="2">
        <div class="review-header">
          <div class="avatar">S</div>
          <div>
            <div class="stars">★★☆☆☆</div>
            <div class="author">Suresh — Madurai, Tamil Nadu</div>
            <div class="date">April 20, 2025</div>
          </div>
        </div>
        <p>Not worth the price. The boat was overcrowded, and we only saw a few dolphins from a distance. The guide seemed disinterested.</p>
        <div class="review-status" style="color: #388e3c;">Genuine Review</div>
      </div>
      <div class="review-card" data-stars="2">
        <div class="review-header">
          <div class="avatar">R</div>
          <div>
            <div class="stars">★★☆☆☆</div>
            <div class="author">Ravi — Mumbai, India</div>
            <div class="date">April 19, 2025</div>
          </div>
        </div>
        <p>Disappointing trip. The weather was cloudy, and we barely saw any dolphins. The island stop was too short to enjoy properly.</p>
        <div class="review-status" style="color: #d32f2f;">Fake Review</div>
      </div>
      <div class="review-card" data-stars="4">
        <div class="review-header">
          <div class="avatar">N</div>
          <div>
            <div class="stars">★★★★☆</div>
            <div class="author">Nisha — Trichy, Tamil Nadu</div>
            <div class="date">April 18, 2025</div>
          </div>
        </div>
        <p>Good cruise with beautiful views of Goa's beaches. The dolphin sighting was a highlight, but the boat could have been cleaner.</p>
        <div class="review-status" style="color: #388e3c;">Genuine Review</div>
      </div>
      <div class="review-card" data-stars="4">
        <div class="review-header">
          <div class="avatar">K</div>
          <div>
            <div class="stars">★★★★☆</div>
            <div class="author">Karthik — Bangalore, India</div>
            <div class="date">April 17, 2025</div>
          </div>
        </div>
        <p>Enjoyable trip with a friendly crew. The dolphin spotting was great, though I wish we had more time to explore the island.</p>
        <div class="review-status" style="color: #388e3c;">Genuine Review</div>
      </div>
    </div>

    <div class="see-more">
      <button id="loadMore">See more reviews</button>
    </div>

    <div class="review-form">
      <h3>Write a Review</h3>
      <form id="review-form">
        <label for="review-name">Your Name</label>
        <input type="text" id="review-name" required>
        <label for="review-rating">Rating</label>
        <select id="review-rating" required>
          <option value="5">5 stars</option>
          <option value="4">4 stars</option>
          <option value="3">3 stars</option>
          <option value="2">2 stars</option>
          <option value="1">1 star</option>
        </select>
        <label for="review-text">Your Review</label>
        <textarea id="review-text" rows="5" required></textarea>
        <button type="submit">Submit Review</button>
      </form>
    </div>
  </section>
</div>

<div class="fullscreen-modal" id="fullscreen-modal">
  <img id="fullscreen-image" src="" alt="Full-screen photo">
  <button class="close-btn" id="close-modal">Close</button>
</div>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const reviewCards = document.querySelectorAll(".review-card");
    const loadMoreBtn = document.getElementById("loadMore");
    const customerPhotos = document.getElementById("customer-photos");
    const photoUpload = document.getElementById("photo-upload");
    const reviewForm = document.getElementById("review-form");
    const reviewList = document.getElementById("review-list");
    const searchReviews = document.getElementById("search-reviews");
    const sortReviews = document.getElementById("sort-reviews");
    const fullscreenModal = document.getElementById("fullscreen-modal");
    const fullscreenImage = document.getElementById("fullscreen-image");
    const closeModal = document.getElementById("close-modal");
    const loading = document.getElementById("loading");
    const progress = document.getElementById("progress");
    const progressText = document.getElementById("progress-text");
    const errorDiv = document.getElementById("error");
    let visibleCount = 3;
    let isMoreLoaded = false;

    // Load stored photos and reviews
    const storedPhotos = JSON.parse(localStorage.getItem("customerPhotos") || "[]");
    const storedReviews = JSON.parse(localStorage.getItem("customerReviews") || "[]");

    // Display stored photos
    displayPhotos(storedPhotos);

    // Display stored reviews
    storedReviews.forEach(review => {
      addReviewToList(review);
    });

    // Handle photo upload with enhancement
    photoUpload.addEventListener("change", async (e) => {
      const files = Array.from(e.target.files);
      for (const file of files) {
        loading.style.display = "block";
        errorDiv.style.display = "none";
        progress.style.display = "block";
        let progressValue = 0;
        const interval = setInterval(() => {
          progressValue = Math.min(progressValue + 1, 95);
          progress.querySelector("progress").value = progressValue;
          progressText.textContent = `${progressValue}%`;
        }, 5700);

        try {
          const enhancedSrc = await enhanceImage(file);
          const photoImg = document.createElement("img");
          photoImg.src = enhancedSrc;
          photoImg.alt = `Customer Photo ${customerPhotos.children.length + 1}`;
          photoImg.addEventListener("click", () => openFullscreen(enhancedSrc));
          customerPhotos.appendChild(photoImg);
          storedPhotos.push(enhancedSrc);
          localStorage.setItem("customerPhotos", JSON.stringify(storedPhotos));
          clearInterval(interval);
          progress.querySelector("progress").value = 100;
          progressText.textContent = "100%";
          setTimeout(() => { progress.style.display = "none"; }, 500);
        } catch (error) {
          console.error("Error:", error);
          errorDiv.textContent = `Failed to enhance image: ${error.message}`;
          errorDiv.style.display = "block";
          clearInterval(interval);
          progress.style.display = "none";
        } finally {
          loading.style.display = "none";
        }
      }
    });

    // Function to display stored photos
    function displayPhotos(photos) {
      photos.forEach((photo, index) => {
        const img = document.createElement("img");
        img.src = photo;
        img.alt = `Customer Photo ${index + 1}`;
        img.addEventListener("click", () => openFullscreen(photo));
        customerPhotos.appendChild(img);
      });
    }

    // Enhance image via API
    async function enhanceImage(file) {
      const formData = new FormData();
      formData.append("file", file);
      formData.append("prompt", "Coastal scene, vibrant colors, detailed, 8k");

      try {
        const response = await fetch("http://localhost:8000/enhance", {
          method: "POST",
          body: formData
        });

        if (!response.ok) {
          const errorText = await response.text();
          throw new Error(`HTTP error! status: ${response.status}, message: ${errorText}`);
        }

        const result = await response.json();
        if (result.error) {
          throw new Error(result.error);
        }

        return result.image_base64;
      } catch (error) {
        throw error;
      }
    }

    // Open full-screen modal
    function openFullscreen(src) {
      fullscreenImage.src = src;
      fullscreenModal.style.display = "flex";
    }

    // Close full-screen modal
    closeModal.addEventListener("click", () => {
      fullscreenModal.style.display = "none";
      fullscreenImage.src = "";
    });

    // Close modal when clicking outside
    fullscreenModal.addEventListener("click", (e) => {
      if (e.target === fullscreenModal) {
        fullscreenModal.style.display = "none";
        fullscreenImage.src = "";
      }
    });

    // Fake review detection
    function detectFakeReview(text) {
      const wordCount = text.split(/\s+/).length;
      const isTooShort = wordCount < 5;
      const isRepetitive = /(.{3,})\1/.test(text);
      const hasSuspiciousWords = /fake|spam|test|random/i.test(text);
      return isTooShort || isRepetitive || hasSuspiciousWords;
    }

    // Handle review submission
    reviewForm.addEventListener("submit", (e) => {
      e.preventDefault();
      const name = document.getElementById("review-name").value.trim();
      const rating = document.getElementById("review-rating").value;
      const text = document.getElementById("review-text").value.trim();
      if (!name || !text) {
        alert("Please fill in all fields.");
        return;
      }
      const now = new Date();
      const timestamp = now.toLocaleString("en-IN", {
        day: "numeric",
        month: "short",
        year: "numeric",
        hour: "2-digit",
        minute: "2-digit",
      });
      const isFake = detectFakeReview(text); // Use detection function
      const review = {
        name,
        rating,
        text,
        timestamp,
        isFake,
      };
      addReviewToList(review);
      storedReviews.unshift(review);
      localStorage.setItem("customerReviews", JSON.stringify(storedReviews));
      reviewForm.reset();
      updateReviewVisibility();
    });

    // Add review to DOM
    function addReviewToList(review) {
      const reviewCard = document.createElement("div");
      reviewCard.className = "review-card visible";
      reviewCard.setAttribute("data-stars", review.rating);
      const stars = "★".repeat(review.rating) + "☆".repeat(5 - review.rating);
      const avatarLetter = review.name.charAt(0).toUpperCase();
      reviewCard.innerHTML = `
        <div class="review-header">
          <div class="avatar">${avatarLetter}</div>
          <div>
            <div class="stars">${stars}</div>
            <div class="author">${sanitizeHTML(review.name)} — India</div>
            <div class="date">${review.timestamp}</div>
          </div>
        </div>
        <p>${sanitizeHTML(review.text)}</p>
        <div class="review-status" style="color: ${review.isFake ? '#d32f2f' : '#388e3c'};">
          ${review.isFake ? "Fake Review" : "Genuine Review"}
        </div>
      `;
      reviewList.insertBefore(reviewCard, reviewList.firstChild);
    }

    // Sanitize HTML
    function sanitizeHTML(str) {
      const div = document.createElement("div");
      div.textContent = str;
      return div.innerHTML;
    }

    // Filter reviews
    document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
      checkbox.addEventListener("change", updateReviewVisibility);
    });

    // Search and sort reviews
    searchReviews.addEventListener("input", updateReviewVisibility);
    sortReviews.addEventListener("change", updateReviewVisibility);

    // Load more reviews
    loadMoreBtn.addEventListener("click", () => {
      const hiddenCards = document.querySelectorAll(".review-card:not(.visible)");
      hiddenCards.forEach((card, index) => {
        if (index < 2) {
          card.classList.remove("hidden");
          card.classList.add("visible");
        }
      });
      isMoreLoaded = true;
      if (document.querySelectorAll(".review-card:not(.visible)").length === 0) {
        loadMoreBtn.style.display = "none";
      }
    });

    // Update review visibility
    function updateReviewVisibility() {
      const selectedRatings = Array.from(document.querySelectorAll(".filter-group:nth-child(2) input:checked"))
        .map(cb => cb.id.replace("-stars", "")).filter(id => id !== "all-ratings");
      const searchQuery = searchReviews.value.toLowerCase();
      const sortBy = sortReviews.value;
      let allReviews = Array.from(reviewList.querySelectorAll(".review-card"));
      if (sortBy === "Sort by: Newest") {
        allReviews.sort((a, b) => {
          const dateA = new Date(a.querySelector(".date").textContent);
          const dateB = new Date(b.querySelector(".date").textContent);
          return dateB - dateA;
        });
      } else if (sortBy === "Sort by: Oldest") {
        allReviews.sort((a, b) => {
          const dateA = new Date(a.querySelector(".date").textContent);
          const dateB = new Date(b.querySelector(".date").textContent);
          return dateA - dateB;
        });
      }
      allReviews.forEach(review => reviewList.appendChild(review));
      allReviews.forEach((card, index) => {
        const stars = parseInt(card.getAttribute("data-stars"));
        const text = card.querySelector("p").textContent.toLowerCase();
        const matchesRating = selectedRatings.length === 0 || selectedRatings.includes(stars.toString());
        const matchesSearch = !searchQuery || text.includes(searchQuery);
        if (matchesRating && matchesSearch) {
          card.classList.remove("hidden");
          card.classList.add("visible");
          if (index >= visibleCount && !isMoreLoaded) {
            card.classList.add("hidden");
            card.classList.remove("visible");
          }
        } else {
          card.classList.add("hidden");
          card.classList.remove("visible");
        }
      });
      loadMoreBtn.style.display = document.querySelectorAll(".review-card:not(.visible)").length > 0 ? "block" : "none";
    }

    // Initial visibility
    updateReviewVisibility();
  });
</script>
</body>
</html>